<HTML>
<HEAD>
<TITLE>
rsa.h
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#include</font> <font color="maroon">"biginteger.h"</font>
<font color="blue">using</font> <font color="blue">namespace</font> std;

<font color="green">/**
 * A class that handle RSA Encryption and Decryption.
 *
 * @author Erick Wijaya 
 * @version 1.0
 * @since 2017-13-07
 */</font>

<font color="blue">class</font> RSA <font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    <font color="green">/**
     * Constructor that constructs new RSA Security with its public and private key.
     * @param digits The amount of digit to generate prime numbers.
     */</font>
    RSA<font color="black">(</font><font color="blue">int</font> digits <font color="black">=</font> DEFAULT_DIGITS<font color="black">)</font>;

    <font color="green">/**
     * Encrypt plaintext into ciphertext.
     * @param plainText The message source.
     * @return encrypted text.
     */</font>
    string encrypt<font color="black">(</font>string plainText<font color="black">)</font>;

    <font color="green">/**
     * Decrypt ciphertext into plaintext.
     * @param cipherText The message source.
     * @return decrypted text.
     */</font>
    string decrypt<font color="black">(</font>string cipherText<font color="black">)</font>;

    <font color="green">/**
     * Return the public key.
     * @return Public key.
     */</font>
    biginteger getPublicKey<font color="black">(</font><font color="black">)</font>;

    <font color="green">/**
     * Return the private key.
     * @return Private key.
     */</font>
    biginteger getPrivateKey<font color="black">(</font><font color="black">)</font>;

<font color="blue">private</font><font color="black">:</font>
    biginteger n; <font color="green">// security parameter</font>
    biginteger e; <font color="green">// public key</font>
    biginteger d; <font color="green">// private key</font>

    biginteger p, q;
    biginteger dp, dq;
    biginteger qInv;

    <font color="blue">static</font> <font color="blue">const</font> <font color="blue">int</font> DEFAULT_DIGITS <font color="black">=</font> <font color="maroon">20</font>;
    <font color="blue">static</font> <font color="blue">const</font> biginteger MULTIPLIER_SUB;
    <font color="blue">static</font> <font color="blue">const</font> biginteger MULTIPLIER_MOD;
<font color="black">}</font>;
</PRE>
</BODY>
</HTML>
